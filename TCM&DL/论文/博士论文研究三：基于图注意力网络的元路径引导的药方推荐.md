# 博士论文研究三：基于图注意力网络的元路径引导的药方推荐

`章节三和章节四中提出的基于图神经网络的药方推荐模型**依据宏观的中医理论体系来完成药方推荐任务**，**缺乏微观层面上对中药作用机制的探索·**`

构建了一个中西医结合知识图谱，并基于此搭建了可解释药方推荐系统

## 元路径引导的图注意力网络模型（Metapathguided Graph Attention Network，简称MGAT）（用于可解释药方推荐任务）

### 数据集：

`TCM-MM`

### 问题定义：

1. 元路径：一条元路径M定义了一个包含实体类型和关系类型的序列
2. 任务描述：给定病人的症状集合，**推荐合适的中药集合**，并**提供推荐理由**（**得到用药推荐后，根据图注意力权重和元路径生成推荐理由**）
3. 输入：所有中药H，所有中医症状S，中医处方集P，图谱G，元路径集合M。 
4. 输出：
   - 1.模型训练好的函数ˆysc=f(sc,H|Θ,P,G,M)，用于给定症状集合sc时，计算对所有候选中药H的预测概率向量ˆysc；
   - 2.得到推荐中药后，模型挑选出中医症状和推荐中药之间的元路径实例作为推荐理由。

### 模型的构建与学习

**元路径引导的图注意力网络表示层**

有4种类型的元路径，知识图谱按照元路径类型进行分类，分类之后，每种类别中路径模式是相同的，之后，每种类型的子图采用一个图注意力网络，再进行融合，之后的方法都是和研究一是一样的

聚合阶段，注意力机制来区分不同邻居的显著性。

具体来说：表示层的主要目标是**为图谱中的实体学习到编码了元路径中丰富语义信息的表示。**



