# 博士论文研究三：基于图注意力网络的元路径引导的药方推荐

`章节三和章节四中提出的基于图神经网络的药方推荐模型**依据宏观的中医理论体系来完成药方推荐任务**，**缺乏微观层面上对中药作用机制的探索·**`

构建了一个中西医结合知识图谱，并基于此搭建了可解释药方推荐系统

## 元路径引导的图注意力网络模型（Metapathguided Graph Attention Network，简称MGAT）（用于可解释药方推荐任务）

### 数据集：

`TCM-MM`

### 问题定义：

1. 元路径：一条元路径M定义了一个包含实体类型和关系类型的序列
2. 任务描述：给定病人的症状集合，**推荐合适的中药集合**，并**提供推荐理由**（**得到用药推荐后，根据图注意力权重和元路径生成推荐理由**）
3. 输入：所有中药H，所有中医症状S，中医处方集P，图谱G，元路径集合M。 
4. 输出：
   - 1.模型训练好的函数ˆysc=f(sc,H|Θ,P,G,M)，用于给定症状集合sc时，计算对所有候选中药H的预测概率向量ˆysc；
   - 2.得到推荐中药后，模型挑选出中医症状和推荐中药之间的元路径实例作为推荐理由。

### 模型的构建与学习

表示层：传播阶段，邻居信息按照章节5.3预定义的元路径传递给中心节点。聚合阶段，注意力机制来区分不同邻居的显著性。具体来说：表示层的主要目标是为图谱中的实体学习到编码了元路径中丰富语义信息的表示。

**依据元路径Mi从图谱G中抽取出子图GM，保证GMi中每条连接中医症状和中药的路径都符合Mi所定义的模式**也就是说：每条元路径对应相应的子图，每个子图单独用GAT来进行学习，再进行聚合

单个元路径引导下的实体表示：

