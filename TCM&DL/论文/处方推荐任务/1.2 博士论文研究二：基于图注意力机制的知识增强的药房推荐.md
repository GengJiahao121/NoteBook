# 博士论文研究二：基于图注意力机制的知识增强的药房推荐

数据集：中医医案数据集 + TCMKG（这个数据集没有得到）

关键词：图注意力机制、知识增强、药方推荐

## SMGCN存在的不足：

1. 构建图时，同质图和二部图都是全连接，我们在进行信息传播时，权重可视为是一样的。但在实际诊疗场景中不成立（具体解释详见博士图）
2. 只使用一个统一的证候表示则忽略了处方内症状和药物之间多样化的对应关系

## 知识增强的图注意力网络KG-ASMGNN

#### 基于证候感知的图卷积神经网络SMGCN，做如下修改：

1. 在症状中药图、症状症状图和中药中药图上进行图注意力卷积操作，**为每个节点学习不同邻居对应的权重**，从而自动区分症状中药之间的对应关系，症状间的共现关系和中药间的配伍关系，降低噪音
2. 引入知识图谱：（如何引入的呢？？？？）

   - 知识图谱也是辅助信息的一大来源  
   - 融入从文献[4]构建的中医知识图谱TCMKG中提取的特征来提升表示学习的质量。该图谱以三元组形式存储了中药的属性和功效，及证候、症状等中医领域相关知识。具体地，**从TCMKG中预先提取中药和症状的实体表示作为节点特征融入模型，使得学习到的表示能同时包含图的拓扑信息和节点的特征信息**。通过引入图谱中丰富的语义有利于增强症状和中药之间的关联，帮助缓解中医文本的数据稀疏性问题。
3. 采用带有注意力机制的多层感知机完成证候归纳。**具体地，对每个候选中药，模型计算它与当前多个症状之间的权重来反映它们之间的对应关系，然后聚合加权后的症状表示得到自适应的证候表示。**

### 模型框架

- `带有注意力的知识增强的多图嵌入层（AttentiveKGenhanced MultiGraph Embedding Layer，简称：AKGMGE`

  1. 同SMGCN处理流程是一样的，就是处理方法变了，有GCN变成了GAT，说白了就是由固定权重变成了自学习权重相互抽取信息
  2. 除了通过二部图症状-中药抽取得到的向量和通过同质图中药-中药，症状-症状抽取得到的向量外，**还有一个通过知识图谱得到的向量**，他们三个向量进行融合

- `带有注意力的证候感知的预测层（Attentive Syndromeaware Prediction Layer，简称：ASI）。`

  - 最终的结果是每一个中药都会有一个针对该中药的隐式证候表示，这个证候表示是怎么得到的呢？

    - 就是该中药向量同所有的症状进行注意力机制得到对于每个症状的权重，再进行聚合，得到针对该中药的隐式证候向量。然后每个中药都是这样的操作，最终也就是每个中药都有一个对应的证候向量，对应相乘，再行相加，再sigmoid得到概率

### 参照的数据集

1. 中医医案数据集TCM
2. 合作单位上海中医药大学提供的肺癌处方数据集（**数据集还没有看是否可以下载下来**）论文来自：JI W,ZHANG Y,WANG X,et al.Latent semantic diagnosis in traditional chinesemedicine[J].World Wide Web,2017,20(5):10711087

