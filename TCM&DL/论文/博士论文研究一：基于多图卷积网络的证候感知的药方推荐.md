# 博士论文研究一：基于多图卷积网络的证候感知的药方推荐
总体上来说：
1. 具体地，模型根据症状在处方中的**共现频率**构建了症状-症状图，然后采用图卷积操作从中提取到症状表示rs。类似地，模型从中药-中药图中学习到中药表示rh

2. 这里的症状-症状图和中药-中药图是所有症状和中药吗？是的，是所有的处方中的症状和中药集合，模型的目的其实是学习症状和中药的最终的融入了关系信息的表示。

## 网络模型框架

### 多图嵌入层

为**所有症状S**和**所有中药H**中学习到全面的**向量化表示**（可以理解为是所有症状和所有中药的嵌入，嵌入之后的向量已经学习到了症状-症状，中药-中药（共现关系），症状-中药之间的关系）。

1. 二分图卷积网络（**嵌入症状-中药关系**）
   - 构建症状-中药二部图：如果s和h在同一个处方中出现过置为1，否则为0
   -  面向症状的消息传播网络 + 面向中药的消息传播网络

根据二部图来进行消息的构造、聚合、再构造、再聚合（说白了就是图卷积神经网络）

2. 协同图编码（面向的是数据集中所有的处方构建**中药-中药，症状-症状图**）：模型根据症状在处方中的共现频率构建症状症状图，然后采用图卷积操作从中提取到症状表示rs。同理学习到中药表示rh。
   - 构建协同图
        
        以中药-中药协同图的构建为例，计算处方集合P中所有中药对的频率，如果中药hm和中药hn同时出现在中药集合hc中，则(hm,hn)的共现频次加1，按照上述计数规则得到中药中药频次矩阵后，本节设置超参数阈值xh来过滤矩阵项。具体地，对于在处方中共现超过xh次的中药对，对应的矩阵项设为1，否则设为0。

   - 消息传播（采用单层图卷积网络处理协同图得到症状和中药的表示）

3. 信息融合（1和2进行求和操作）

### 证候归纳
- 处理过程：
  1. **多热向量**表示症状集合sc，如果sc包含症状s，则相应的维度设为1，否则设为0
  2. 其次从章节3.3.3得到的e∗S∈RM×d中**查找出sc中多个症状对应的表示向量**，将这些向量**组织成矩阵es**c∈R|sc|×d；
  3. 然后采用**平均池化**操作Mean(·)来归纳矩阵esc得到单个的表示；
  4. 最后考虑到证候归纳的复杂性，本节使用非线性的**多层感知机**来处理上一步得到的单个向量**得到证候表示**

### 药方推荐

- 证候表示向量 \* 所有的中药特征向量 -\> 维度为N的多热预测概率向量





